<ion-header>
  <ion-toolbar>
    <ion-buttons collapse="true" slot="start">
      <ion-button [style.visibility]="(isBeginning) ? '' : 'hidden'" (click)="home()">
        <ion-icon name="arrow-back"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ng-container *ngIf="currentSlide === 'Waiters List'">
      <ion-buttons collapse="true" slot="end">
        <ion-button (click)='resetWaitersListForm()'>
          <ion-icon color='warning' slot="icon-only" name="close-outline"></ion-icon>
        </ion-button>
        <ion-button (click)='addWaiterField()'>
          <ion-icon color='success' slot="icon-only" name="add-outline"></ion-icon>
        </ion-button>
      </ion-buttons>
    </ng-container>
    <ng-container *ngIf="currentSlide === 'Date'">
      <ion-buttons collapse="true" slot="end">
        <ion-button>
          <ion-icon color='warning' slot="icon-only" name="close-outline"></ion-icon>
        </ion-button>
      </ion-buttons>
    </ng-container>
  </ion-toolbar>
  <ion-toolbar>
    <div
      class="slider-header flex justify-content-space-between ion-margin-start ion-margin-end ion-margin-top relative">
      <div class="absolute full-width line"></div>
      <div class="flex flex-column justify-content-center "
        *ngFor="let slide of slides; let index = index; let first = first; let last = last;">
        <span [ngClass]="{ 'align-self-end': last, 'align-self-center': (!first && !last) }"
          class="flex flex-column align-items-center justify-content-center bold text-medium radius"
          style="width: 30px; height: 30px;"
          [style.background]="slide === currentSlide ? 'var(--ion-color-warning)':'var(--ion-color-light-shade)'"
          [style.color]="slide === currentSlide ? 'var(--ion-color-dark)':'var(--ion-color-dark)'"
          [ngClass]="{ 'align-self-end': last, 'align-self-center': (!first && !last) }">
          {{ index + 1 }}
        </span>
        <!-- <span [style.color]="slide === currentSlide ? 'var(--ion-color-warning)':'var(--ion-color-medium)'"
          [ngClass]="{ 'align-self-end': last, 'align-self-center': (!first && !last) }"
          class="description flex text-medium bold ion-margin-vertical">
          {{ slide }}
        </span> -->
      </div>
    </div>
  </ion-toolbar>
  <ion-toolbar *ngIf='waitersListDataSubject'>
    <ion-list>
      <ion-item *ngFor='let waiter of waitersListDataSubject| async'>
        <ion-label>{{ waiter.name }}</ion-label>
      </ion-item>
    </ion-list>   
  </ion-toolbar>
</ion-header>

<ion-content color='warning'>
  <ion-slides [options]="slidesOpts" (ionSlideDidChange)="onSlidesDidChange()" (ionSlideWillChange)="onSlidesChanged()">
    <ng-container *ngFor="let slide of slides">
      <ion-slide>
        <div class="slide-content ion-margin-start ion-margin-end full-width full-height ion-text-start">
          <div *ngIf="slide === 'Waiters List'">

            
            <form [formGroup]="waitersListForm" #waitersFormRef="ngForm">
              <div formArrayName="waitersList">
                <div @fade *ngFor="let waiter of waitersListArray.controls; let i = index" [formGroupName]="i">

                  <mat-card class='container'>
                    <mat-card-content>
                      <ion-row>
                        <ion-col size="12">
                          <ion-buttons class='delete-button'>
                            <ion-button (click)="deleteWaiter(i)">
                              <ion-icon size='small' color='danger' class='delete-icon' name="close"></ion-icon>
                            </ion-button>
                          </ion-buttons>
                        </ion-col>
                        
                        <ion-col size="12">
                          <ion-list-header>
                            <ion-label>Name</ion-label>
                            <ion-button color='dark' fill='outline' shape="round" (click)='returnWaiter(i)'>returnWaiter
                            </ion-button>
                          </ion-list-header>
                          <ion-item>
                            <ion-item>
                              <ionic-selectable #selectNameComponent formControlName='name' itemValueField="id"
                                itemTextField="name" [items]="waitersListDataSubject | async" (onChange)="waitersListChange($event,i)">
                              </ionic-selectable>
                            </ion-item>
                          </ion-item>
                          <ion-item
                            *ngIf="waitersListArray.controls[i].get('name')?.errors?.required && isNameValidFormSubmitted !== null && !isNameValidFormSubmitted">
                            <ion-text color="danger">
                              Please add valid waiter
                            </ion-text>
                          </ion-item>
                        </ion-col>
                        

                        <ion-col size="12">
                          <ion-list-header>
                            <ion-label>Points</ion-label>
                            <ion-button color='dark' fill='outline' shape="round" (click)='clearSelectedPoints(i)'>Clear
                            </ion-button>
                          </ion-list-header>
                          <ion-item>
                            <ionic-selectable #selectPointsComponent [items]="pointsList" closeButtonText="Close"
                              closeButtonSlot="end" itemValueField="id" itemTextField="label" [isMultiple]="true"
                              confirmButtonText="OK" (onChange)='onPointsListChange($event, i)'>
                              <!-- <ng-template ionicSelectableIconTemplate>
                                <ion-icon name="compass"></ion-icon>
                              </ng-template> -->
                              <ng-template ionicSelectableItemTemplate let-point="item"
                                let-isPortSelected="isItemSelected">
                                {{ point.label }} ({{ point.value }})
                              </ng-template>
                              <ng-template ionicSelectableValueTemplate let-points="value">

                                <ion-item lines="none" class="points-list" *ngFor="let port of points">
                                  <ion-label>
                                    {{ port.label }}
                                  </ion-label>
                                  <ion-note slot='end'>
                                    {{ port.value }}
                                  </ion-note>
                                </ion-item>

                              </ng-template>
                              <ng-template ionicSelectableHeaderTemplate>
                                <ion-header>
                                  <ion-toolbar color='dark'>
                                    <ion-buttons>
                                      <ion-button (click)="selectPointsComponent.close()">
                                        {{selectPointsComponent.closeButtonText}}
                                      </ion-button>
                                    </ion-buttons>
                                    <ion-title>
                                      {{selectPointsComponent.label}}
                                    </ion-title>
                                  </ion-toolbar>
                                </ion-header>
                              </ng-template>
                              <ng-template ionicSelectableFooterTemplate>
                                <ion-toolbar color='dark'>
                                  <ion-buttons class="full-width flex align-items-center justify-content-space-between">
                                    <ion-button fill='solid' shape="round" color="medium" (click)="togglePoints()">
                                      {{ selectPointsComponent.itemsToConfirm.length ? 'Deselect' : 'Select' }}
                                      All
                                    </ion-button>
                                    <ion-button fill='solid' shape="round" color="success" (click)="confirm()">
                                      <span>{{selectPointsComponent.confirmButtonText}}</span>
                                    </ion-button>
                                  </ion-buttons>
                                </ion-toolbar>
                              </ng-template>
                            </ionic-selectable>
                          </ion-item>

                          <!-- <ion-item *ngFor='let point of waitersListArray.controls[i].get("points").value'>
                            <ion-label>
                              {{ point.label }}
                            </ion-label>
                            <ion-note slot='end'>
                              {{ point.value }}
                            </ion-note>
                          </ion-item> -->
                          <ion-item
                            *ngIf="waitersListArray.controls[i].get('points')?.errors?.required && isPointValidFormSubmitted !== null && !isPointValidFormSubmitted">
                            <ion-text color="danger">
                              Add the points criterias
                            </ion-text>
                          </ion-item>
                        </ion-col>
                        <ion-col size="12">
                          <ion-list-header>
                            <ion-label>Hours</ion-label>
                            <ion-button color='dark' fill='outline' shape="round" (click)='clearSelectedHour(i)'>
                              Clear
                            </ion-button>
                          </ion-list-header>
                          <ion-item>
                            <ion-label *ngIf='waitersListArray.controls[i].get("hours").value !== null'> {{
                              waitersListArray.controls[i].get('hours').value }} </ion-label>
                            <ion-buttons slot="end" *ngIf='!waitersListArray.controls[i].get("hours").value'>
                              <ion-button (click)="showPicker(i)" expand="block" fill="clear" shape="round">
                                <ion-icon name="timer-sharp"></ion-icon>
                              </ion-button>
                            </ion-buttons>
                          </ion-item>
                          <ion-item
                            *ngIf="waitersListArray.controls[i].get('hours')?.errors?.required && isHoursValidFormSubmitted !== null && !isHoursValidFormSubmitted">
                            <ion-text color="danger">
                              Add hours to the waiter
                            </ion-text>
                          </ion-item>
                        </ion-col>

                      </ion-row>
                    </mat-card-content>
                  </mat-card>

                </div>
              </div>
            </form>
          </div>


          <div *ngIf="slide === 'Date'">
            <ion-row class='date-row'>
              <ion-col size="12">
                <ion-title color='warning'> Selected date: {{date | date }} </ion-title>
                <mat-card class="inline-calendar-card">
                  <mat-calendar [(selected)]="date"></mat-calendar>
                </mat-card>
              </ion-col>
            </ion-row>
          </div>

          <div *ngIf="slide === 'Tips'">
            <ion-row class='tips-row'>
              <ion-col size="12">
                <ion-title color='warning'> Tips </ion-title>
                <ion-label color='light'> How did we make today? </ion-label>

              </ion-col>
            </ion-row>
          </div>

          <div *ngIf="slide === 'Summary'">
            <ion-title color='warning'> Summary </ion-title>
            <ion-row class='summary-row'>
              <ion-col size="12">

                <ion-item lines="none">
                  <ion-label color="primary">
                    <h1>Hello</h1>
                  </ion-label>
                </ion-item>

              </ion-col>
            </ion-row>
          </div>

        </div>
      </ion-slide>
    </ng-container>
  </ion-slides>
</ion-content>
<ion-footer *ngIf="!isEnd">
  <ion-toolbar>
    <div>
      <ion-buttons class="full-width flex align-items-center justify-content-space-between">
        <ion-button fill='solid' shape="round" color="medium"
          [style.visibility]="(isBeginning || isEnd) ? 'hidden' : ''" (click)="onBackButtonTouched()">
          <span>Back</span>
          <ion-icon slot="start" name="chevron-back"></ion-icon>
        </ion-button>
        <ion-button fill='solid' shape="round" color="warning" [style.visibility]="isEnd ? 'hidden' : ''"
          (click)="onNextButtonTouched()">
          <span>Next</span>
        </ion-button>
      </ion-buttons>
    </div>
  </ion-toolbar>
</ion-footer>
<ion-footer *ngIf="isEnd">
  <ion-toolbar>
    <div>
      <ion-buttons class="full-width flex align-items-center justify-content-space-between">
        <ion-button fill='solid' shape="round" color="medium" (click)="onBackButtonTouched()">
          <span>Back</span>
          <ion-icon slot="start" name="chevron-back"></ion-icon>
        </ion-button>
        <ion-button fill='solid' shape="round" color="primary" (click)="home()">
          <span>Share/Home</span>
        </ion-button>
        <ion-button fill='solid' shape="round" color="success" (click)="submitForm()">
          <span>Finish</span>
        </ion-button>
      </ion-buttons>
    </div>
  </ion-toolbar>
</ion-footer>